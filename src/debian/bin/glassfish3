#!/usr/bin/env bash
#
# glassfish init script for Linux

GF3_HOME=/usr/share/glassfish3/glassfish
USER=glassfish

LOGS_DIR=/var/log/glassfish3
DOMAINS_HOME=/var/glassfish3
DOMAIN_NAME=domain1

##################################################
# Get the action & configs
##################################################
ACTION=$1

##################################################
# Setup JAVA if unset
##################################################
if [ -z "$JAVA" ]
then
  JAVA=$(which java)
fi

if [ -z "$JAVA" ]
then
  echo "Cannot find a Java JDK. Please set either set JAVA or put java (>=1.6) in your PATH." 2>&2
  exit 1
fi

##################################################
# Do the action
##################################################
case "$ACTION" in
  check)
    echo "Checking installation:"
    echo "JAVA     = $JAVA"
    echo
    
    exit 1

    ;;

  start)
    echo "Starting Glassfish please wait ....."
    sudo -u $USER $GF3_HOME/bin/asadmin start-domain --domaindir $DOMAINS_HOME $DOMAIN_NAME

    exit 1

    ;;

  stop)
    echo "Stopping Glassfish please wait ....."
    sudo -u $USER $GF3_HOME/bin/asadmin stop-domain --domaindir $DOMAINS_HOME $DOMAIN_NAME

    exit 1

   ;;

  restart)
    echo "Restarting Glassfish please wait ....."
    sudo -u $USER $GF3_HOME/bin/asadmin restart-domain --domaindir $DOMAINS_HOME $DOMAIN_NAME

    exit 1

    ;;

  *)
    echo "usage: $0 (check|start|stop|restart)"

    exit 1

    ;;
esac

exit 0
